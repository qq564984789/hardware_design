### 硬件设计实例一：自平衡车
1. **需求分析**
  - STM32最小系统
  - 两个车轮：两个H桥驱动+两个编码器接口
  - 小车姿态：陀螺仪（包括倾角，转向角，角速度等）
  - 人机接口（调试和指示用的外设）：蜂鸣器，LED
  - 下载、调试接口：
  - 系统供电：电源电路
  - 电压检测：电池电压采集电路，做低压报警，防止电池过放。
2. **元器件选型**
  - 根据各电路功能模块，确定元器件类型、封装（对于一些比较特殊的电路，即使是电阻电容这样常见的无源器件也需要认真选择然而平衡小车的电路中并不需要一些高精度或很高速的电路部分。）
    - 最小系统：STM32F405RGT6，这款主控是M3内核的，主频可以达到168M,性能非常强悍，非常适合以后的开发和拓展。
	- 两个轮子电机需要两个H桥驱动:
	  - 驱动的选择和电机的参数紧密相关
	  - 选用的电机的正常工作电流360mA
	  - 选择东芝的电机驱动芯片 TB6612:两个集成的H桥，可以同时驱动两个电机，每个H桥可以持续输出 1.2A的电流，PWM频率可以到100kHz，芯片的供电电压最大可以到15V，适合用3S 电池供电，并且芯片封装很小，节省PCB面积。
	- 系统供电：
	  - 小车电池采用3S锂聚合物电池，放电率25C，以后做四轴还能用。电池的满电电压12.6V左右
	  - 电路中需要5V和 3.3V的电源。
	  - 12V-5V降压：MPS公司的DCDC降压芯片MP2482，该芯片支持最大 5A电流输出，最大28V电压输入，0.8至25V可调电压输出，符合需求
	  - 5V-3.3V降压：选用 常见的AMS1117-3.3。
	- 陀螺仪：选用MPU6050模块，模块自带了软件滤波算法，采用串口对外输出数据， 在115200波特率的情况下，每秒钟可以输出100帧的数据。
3. **原理图设计**
  - 最小系统+电源电路+下载调试电路+其他功能模块
4. **PCB设计**
   - 电源去耦
   - 线宽控制：大电流的走线要尽量宽
   - 开关电源（集成的DCDC电路）的布局布线：
     - 一是芯片的SW的信号是电压高，频率高的开关信号，会对其他电路产生严重的干扰，要尽量远离敏感的电路。
	 - 二是反馈网络是很敏感的网络，尽量避免受干扰。
	 - 三是电源的电流较大，注意线宽和过孔的数量、孔径等，保证有能力通过这么大的电流。
5. **焊接调试**
  - 首先焊接电源部分，上电测试电源无问题后在继续其他部分。
  
  
[详情参阅](http://mp.weixin.qq.com/s/tcg2XQSW6ukDPoeInvpyHw)
